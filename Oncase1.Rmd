---
title: "teste"
author: "Pedro"
date: "26/01/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
install.packages("kableExtra")
install.packages("ggcorrplot")
```
Carregamento dos outliers que serão utilizados na análise descritiva de dados

```{r cars}
library(readxl)
library(tidyverse)
library(kableExtra)
library(ggcorrplot)

```

Leitura da base de dados para realização da análise descritiva dos dados. A estratégia utilizada será a realização de gráficos e medidas de posição para detectar o comportamento dos indicadores "Fat", "Calories", Protein" nos tipos de receita e/ou categorias, bem como sua relação com o score dos pratos. 
```{r}
receita <- read_excel("~/Job/Oncase desafio/Receita_json_Oficial.xlsx")

```


##Renomear as variáveis que serão utilizadas, bem como análise inicial dos dados:
Percebe-se que temos um data-frame com dados numéricos e categóricos. Após filtro preliminar, restou uma base de dados de diversos tipos de receitas, o qual, cada linha contém uma categoria e diversos indicadores numéricos.

```{r}
receita = rename(receita, fat = Column1.fat,
       date = Column1.date,
       categories = Column1.categories,
       calories = Column1.calories,
       protein = Column1.protein,
       rating = Column1.rating,
       title = Column1.title,
       sodium = Column1.sodium)
glimpse(receita)

head(receita)
```




Ao realizar uma sumarização dos principais resultados, percebe-se que há muitos dados faltantes "NA" nas variáveis numéricas. Ao analisar os valores máximos destas variáveis, percebe-se uma discrepância se comparado as medidas de posição.



```{r}
summary(receita)
```



Inicialmente a base de dados apresenta 17.776 tipos diferentes de receitas, classificadas em 675 categorias. 

```{r}
summary(unique(receita$title))
summary(unique(receita$categories))


```


Percebemos a presença de informações NA e NaN, por isso utilizamos a função abaixo para excluir estes casos. 

```{r}
rec_title<- receita %>% 
  dplyr::distinct(title, .keep_all = TRUE) %>% 
  drop_na()
rec_title
```

Selecionamos apenas as variáveis núméricas para realizar uma análsie de correlação.
Verifica-se a baixa correlação entre o rating e as variáveis "fat", "calories", "protein" e "sodium".

Logo esta taxa rating tem mais a ver com a qualidade/sabor da receita.


```{r}
rec_title %>% 
  select(-2,-3,-7) %>% 
  cor()
#cor(rec_mo)
```

Abaixo podemos verificar a distribuição das variáveis. Podemos perceber a presença de informações atípicas na base de dados em análise.

```{r}
ggplot(rec_title, aes(x="", y=fat ))+
  geom_boxplot(col="red")

ggplot(rec_title, aes(x="", y=calories ))+
  geom_boxplot(col="red")

ggplot(rec_title, aes(x="", y=protein ))+
  geom_boxplot(col="red")

ggplot(rec_title, aes(x="", y=sodium ))+
  geom_boxplot(col="red")


ggplot(rec_title, aes(x="", y=rating ))+
  geom_boxplot(col="red")

```




```{r}
ggplot(rec_title, aes(x="", y=fat ))+
  geom_boxplot(col="red")
```





```{r}
base$idade <- as.integer(base$idade)
```






Avaliar a quantidade de Na's.

```{r}
summary(receita)
```



```{r}
rec_mo<-na.omit(rec_m)

rec_mo <- receita %>%
  drop_na()%>%
  group_by(categories)%>%
  summarise(m_fat = mean(fat, na.rm = TRUE ),
            m_calories = mean(calories, na.rm = TRUE),
            m_sodium = mean(sodium, na.rm = TRUE),
            m_protein = mean(protein, na.rm = TRUE))

rec_mo
```
```{r}
#rec_mo$m_fat <- as.numeric(rec_mo$m_fat)

#rec_mo$m_fat

rec_mo


```


```{r}
rec_mo<-na.omit(rec_m)
```




```{r}
summary(rec_mo)
```



```{r}

```


Observar se ainda há NA's
```{r}
summary(rec_mo)
```
```{r}

rec_mo %>% 
  select(-1) %>% 
  cor()
#cor(rec_mo)
```




```{r}
mean(rec_mo$m_fat, na.rm = TRUE)
cor(rec_mo$m_fat, rec_mo$m_sodium)

round(mean(rec_mo$m_fat, na.rm = TRUE),3)

round(cor(rec_mo$m_fat, rec_mo$m_sodium),3)
```
```{r}
ggplot(rec_mo, aes(x=m_fat, y=m_sodium))+
  geom_point(col="red")+
  labs(x="Média de gordura",
       y="Média de Sódio",
       title="Diagrama de Dispersão")+
  theme_bw()
  

```


```{r}

ggplot(rec_mo, aes(x="", y=m_sodium))+
  geom_boxplot(col="red")

```




Calcular correlação
```{r}
cor(rec_mo)
```

